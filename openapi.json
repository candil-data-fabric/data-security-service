{"openapi":"3.1.0","info":{"title":"Data Security Service - REST API","version":"1.1.0"},"paths":{"/policies":{"get":{"tags":["Read"],"summary":"Get Policies","description":"Retrieve list of registered policies.","operationId":"get_policies_policies_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetPoliciesResponse"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"type":"string","title":"Response 500 Get Policies Policies Get"}}}}}}},"/policies/{policy_name}":{"get":{"tags":["Read"],"summary":"Get Policy Content","description":"Retrieve policy contents.","operationId":"get_policy_content_policies__policy_name__get","parameters":[{"name":"policy_name","in":"path","required":true,"schema":{"type":"string","title":"Policy Name"}},{"name":"as_file","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"As File"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetPolicyResponse"}}}},"404":{"content":{"application/json":{"schema":{"type":"string","title":"Response 404 Get Policy Content Policies  Policy Name  Get"}}},"description":"Not Found"},"500":{"content":{"application/json":{"schema":{"type":"string","title":"Response 500 Get Policy Content Policies  Policy Name  Get"}}},"description":"Internal Server Error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Create"],"summary":"Register Policy","description":"Register policy.","operationId":"register_policy_policies__policy_name__post","parameters":[{"name":"policy_name","in":"path","required":true,"schema":{"type":"string","title":"Policy Name"}}],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_register_policy_policies__policy_name__post"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterPolicyResponse"}}}},"500":{"content":{"application/json":{"schema":{"type":"string","title":"Response 500 Register Policy Policies  Policy Name  Post"}}},"description":"Internal Server Error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Update"],"summary":"Update Policy","description":"Update an existing policy.","operationId":"update_policy_policies__policy_name__put","parameters":[{"name":"policy_name","in":"path","required":true,"schema":{"type":"string","title":"Policy Name"}}],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_update_policy_policies__policy_name__put"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdatePolicyResponse"}}}},"500":{"content":{"application/json":{"schema":{"type":"string","title":"Response 500 Update Policy Policies  Policy Name  Put"}}},"description":"Internal Server Error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Delete"],"summary":"Delete Policy","description":"Delete policy.","operationId":"delete_policy_policies__policy_name__delete","parameters":[{"name":"policy_name","in":"path","required":true,"schema":{"type":"string","title":"Policy Name"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeletePolicyResponse"}}}},"404":{"content":{"application/json":{"schema":{"type":"string","title":"Response 404 Delete Policy Policies  Policy Name  Delete"}}},"description":"Not Found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"Body_register_policy_policies__policy_name__post":{"properties":{"file":{"type":"string","format":"binary","title":"File"}},"type":"object","required":["file"],"title":"Body_register_policy_policies__policy_name__post"},"Body_update_policy_policies__policy_name__put":{"properties":{"file":{"type":"string","format":"binary","title":"File"}},"type":"object","required":["file"],"title":"Body_update_policy_policies__policy_name__put"},"DeletePolicyResponse":{"properties":{"message":{"type":"string","title":"Message"}},"type":"object","required":["message"],"title":"DeletePolicyResponse","description":"Model for DELETE /policies/{policy_name} response."},"GetPoliciesResponse":{"properties":{"policies":{"items":{"type":"string"},"type":"array","title":"Policies"}},"type":"object","required":["policies"],"title":"GetPoliciesResponse","description":"Model for GET /policies response."},"GetPolicyResponse":{"properties":{"policy_name":{"type":"string","title":"Policy Name"},"rego_content":{"type":"string","title":"Rego Content"}},"type":"object","required":["policy_name","rego_content"],"title":"GetPolicyResponse","description":"Model for GET /policies/{policy_name} response."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"RegisterPolicyResponse":{"properties":{"registered_policy":{"type":"string","title":"Registered Policy"}},"type":"object","required":["registered_policy"],"title":"RegisterPolicyResponse","description":"Model for POST /policies/{policy_name} response."},"UpdatePolicyResponse":{"properties":{"message":{"type":"string","title":"Message"}},"type":"object","required":["message"],"title":"UpdatePolicyResponse","description":"Model for PUT /policies/{policy_name} response."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}